# 浏览器渲染原理

## 什么是渲染？
将字符串转换为每一个像素点信息
## 渲染时间点
网络进程开启多个网络线程去获取html，然后创建一个渲染任务给消息队列，等待渲染主线程执行
## 浏览器是如何渲染页面的？
当浏览器的网络线程收到**HTML**文档后，会产生一个渲染任务，并将其传递给渲染主线程的消息队列。
在事件循环机制的作用下，渲染主线程取出消息队列中的渲染任务，开启渲染流程。
整个渲染流程分为多个阶段，分别是：HTML解析、样式计算、布局、分层、绘制、分块、光栅化、画
每个阶段
1. 解析**HTML**，生成两棵树：**DOM**（Document Object Model）树和**CSSOM**（CSS Object Model）树。
解析过程中遇到**CSS**解析**CSS**，遇到**JS**执行**JS**。为了提高解析效率，会启动一个预解析的线程，率先下载**HTML**中的外部的**CSS**文件和外部的**JS**文件。
如果渲染主线程解析到`link`位置，此时外部的**CSS**文件还没有下载解析好，主线程不会等待，极细解析后续的**HTML**。这是因为下载和解析CSS的工作是在预解析线程中进行的。这就是**CSS**不会阻塞**HTML**解析的根本原因。
如果渲染主线程遇到`script`位置，会暂停解析**HTML**，转而等待**JS**文件下载好，并将全局代码解析执行完成后，才能继续解析**HTML**。这是因为JS代码的执行过程汇总可能会修改当前的**DOM**树，所以**DOM**树的生成必须暂停。这就好似**JS**会阻塞**HTML**解析的根本原因。
第一步完成后，会得到**DOM**树和**CSSOM**树，浏览器的默认样式、内部样式、外部样式和行内样式均会包含在**CSSOM**树中。
2. 样式计算，渲染主线程会遍历得到的**DOM**树，依次为树中的每个节点计算出它的最终样式，称之为**Computed Style**。在这一过程中，很多预设值会变成绝对值，比如颜色会转换为rgb；相对单位会转换为绝对单位等。
第二步完成后，会得到一颗带有样式的DOM树。